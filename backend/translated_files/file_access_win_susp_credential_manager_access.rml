logsource matches {product: 'windows', category: 'file_access'};

selection matches {filename|contains: '\AppData\Local\Microsoft\Credentials\' | '\AppData\Roaming\Microsoft\Credentials\' | '\AppData\Local\Microsoft\Vault\' | '\ProgramData\Microsoft\Vault\'};
filter_system_folders matches {image|startswith: 'C:\Program Files\' | 'C:\Program Files (x86)\' | 'C:\Windows\system32\' | 'C:\Windows\SysWOW64\'};
safe_selection not matches {filename|contains: '\AppData\Local\Microsoft\Credentials\' | '\AppData\Roaming\Microsoft\Credentials\' | '\AppData\Local\Microsoft\Vault\' | '\ProgramData\Microsoft\Vault\'};
safe_filter_system_folders not matches {image|startswith: 'C:\Program Files\' | 'C:\Program Files (x86)\' | 'C:\Windows\system32\' | 'C:\Windows\SysWOW64\'};

Main = logsource >> Monitor!;
Monitor = (safe_selection /\ safe_filter_system_folders)*;